import{bh as j,bi as D,d as C,af as X,ag as G,ah as x,ai as e,o as s,ba as o,bj as ie,c as r,h as Z,n as K,be as P,bb as c,ad as g,ak as E,ae as S,am as J,bc as M,ao as V,q as ee,f as te,r as H,aS as re,a7 as F,l as ae,Z as de,x as $,C as ue,aa as pe,g as ve,bk as Ae}from"./index-4d976010.js";import{i as fe,c as le,V as me,d as se,h as ne,f as oe,g as ce}from"./VOverlay-c8384675.js";class Ct{constructor(n,a,l=!1){this.pos=n,this.wrapper=a,this.observer=l}post(n){this.observer||this.wrapper.game.input({...n})}autoPost(n){this.post({...n,player:this.pos})}getPlayer(){return this.wrapper.game.player[this.pos]}}class N{constructor(){this.notify=[]}emit(n){this.notify.forEach(a=>a(n))}}class St{constructor(){this.server=new N,this.server.notify.push(()=>{this.loading||this.autoSave()}),this.game=new j({Pack:["核心"],Seed:1,Role:["白板"],Mutation:[]},this.server),this.save={config:{},old:[D.serialize(this.game)],new:[]},this.loading=!1,this.saveStateChanged=()=>{}}unbind(){this.game.$ignore$Server=new N}bind(){this.game.$ignore$Server=this.server,this.loading=!0,this.server.emit(this.game.getState()),this.loading=!1}init(n,a={}){this.unbind(),this.game=new j(n,this.server),this.save={config:a,old:[D.serialize(this.game)],new:[]},this.saveStateChanged()}load(n){this.save=n,this.loadActive()}loadActive(){this.unbind(),this.game=D.deserialize(this.save.old[this.save.old.length-1]),this.bind(),this.saveStateChanged()}undo(){this.save.old.length>1&&(this.save.new.push(this.save.old.pop()),this.loadActive())}redo(){this.save.new.length>0&&(this.save.old.push(this.save.new.pop()),this.loadActive())}getState(){return{canRedo:this.save.new.length>0,canUndo:this.save.old.length>1}}autoSave(){this.save.new=[],this.save.old.push(D.serialize(this.game)),this.saveStateChanged()}}const ye=["_acc"],T=C({__name:"AutoButton",props:{variant:{default:"elevated"},accelerator:{default:null}},setup(t){const n=X();return(a,l)=>(s(),G(fe,{class:"auto-button",variant:t.variant,size:e(n).isMobile?"x-small":"large"},{default:x(()=>[o("span",{_acc:t.accelerator?`[${t.accelerator}]`:""},[ie(a.$slots,"default")],8,ye)]),_:3},8,["variant","size"]))}});const Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAWCAMAAAAcqPc3AAABiVBMVEUAAAAAAP8AgIAAVapAQIAzZpkrVYAkSZIgYJ8zZpkuXYsnYokwYI8tWpYrVZUpXI8kW5IsWI0pWpQoWI8nXZMsV5IpWpErW5InWZAnWJMrWpIoWZIpWpIoWpAqW5MpWpEoWZIrXJAqWpEoWpIoWZArW5IqWpAqWZEpW5AoWZIoW5EqWpIqWZApWpEpWpAoW5EoWpIpWpAoW5AqWZIqW5EpWZApW5EoWpAqWZEoWZEoW5ApWpIoWZEoW5EqWpApWZEpWpEoWpEpWpAoWpIqWZEqW5EpWpApW5AqWZIpWpEoWpAoW5EpWpEpW5EqWpEpW5EpW5EpWpIpW5EpWpEpWpEoWpAqWpEpWZIpWZEpWpEqWpApW5EpWpIpWpEpW5EoWpEpWpEpWpEpWpEoWZEpWpEpWpEpWZEpWpIpW5EqWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpEoWpEpWZEpWpEpWpEpW5EpWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpEpWpH///9iquSlAAAAgXRSTlMAAQIDBAUGBwgKCw0QERgZHB0fICEjJSouNDY/REdJSk1OT1JTVFVWV1laW1xdXl9gY2VnaGprbG1yc3d4eXp7fX+DhYaHiIqMkJGSlJWZo6mqtLu8vb6/wsPExcbHyMrMzs/Q0dLT1NbX2Nna3N7f4OPk5ebn6uzu7/Hz9/j5+vygaELFAAAAAWJLR0SCi7P/RAAAATRJREFUGBltwQc3QmEABuC3IknIyEhGqWyykln2zsgudclIiJIV4v3n7ndzTufgeZCn3y7Bf+a5hH9Uf3x91uAvu9/ib0OeNiiFAoHA/qENjXshSTjWAbBQsWuqHzOXb1LRDGCVQnTYTWYM7hAFP4BEoH2G5GNTgpw6I7ni2HlQodZXZh6n7J0/vHVGXz0MsPI3BwoBWHkiMe9Eoh2CNV26y7wDQ9IOoaWr6jXbPkHB5/jImJytECrUR5ODxgyFt8r+ibC6Agobb3sjzJFcV3RCoY7Sc3EWoxA7jw/xUg2hgymdtyRG4Vo/rb1nJ2SaOEeAVua0AYO8KQAwwKQOiJDMkjxVQXvHPqA4xWcp3EXZMmWukPTERBE8L7L1YHprcc4wu7CRulijbBSK2h4NclTdDRC+AT2KgPJ9IL5pAAAAAElFTkSuQmCC",ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAfCAMAAADZe72GAAABQVBMVEUAAAD//wD//wD/qlW/v0DMzDPV1Svb20no0UbVv0DYxDvhwzzjxjnkyUPZzEDbzj3eyEPfykDbyEDcyj7fx0DgyT7hyzzbzELgxz7byjveyTzgyz7gxz3cyDzdyUDeyz3cyj7eyT/eyj7fyj3fx0DgyD/cyT7fykDgyz/fyD3fyT3eyj7eyj3fyT7fyj3eyT7fyD/dyj/eyT3fyD7dyT3fyT/dyj7dyD3eyT7fyT7eyj7eyT3eyT7eyD/fyT7fyT3eyT7dyT7dyT/eyT7eyT7eyT3eyT7eyj7eyD3eyT7eyT3eyD7eyT7eyT/eyT7eyT7eyT7eyT7fyT3eyT7eyT3dyT7eyj7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7eyT7///8gDrLIAAAAaXRSTlMAAQIDBAUGBwsMDRESExQVFxgcHSAhIiMpKy8xMjM0Njo9Pj9AQUJISU9QVlxfYGNmaWxvcXZ4eXt/i5Kco6Wmqq6vsrS3uLq7wcPJztDT1trb3N/g5OXn6Orr7PDx8vP09vj5+vv8/f6Lin9bAAAAAWJLR0RqJWKVDgAAAP9JREFUGBldwQc7QgEAhtG3CGWUSLKbCNmSEdmR2SCblu///wFX6tF1DgxaMfNHMAukMAvWvJgEtYtJSJqnVUh69dEiJCnr4k9Iyq/MUudzAWEpAUMdGLov2iEsbcBExoPhYQHCUgqsHzd2IHcEEakyiqOsBFAogL8kFTdPpJwFx2cJsK1VZdhZ6iWuZ6CnPy7DFpZYRddgL76NP8mQuZO0B+4vRU/VtAhMTluO1VB2wtwYUyU1JMHxWL2tqaE6AstqsQ0cyJA7LMtw2QVcSUp2si4p78HwLp3bICDlvPx4UWUYiOnMSV1W+4A1vdrGr7SigMdNU0J9mAzc888MJt/I0kvypbVLxQAAAABJRU5ErkJggg==",he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAaCAMAAABrajdMAAAB4FBMVEUAAAD/AP+AAICAQICZM5mAK4CSJJKAIJ+OHI6AM5mLLouAK5WJJ4mAJJKHLZaOK46GKJSMJoyGJJKFLJCFKY+JJ5OEJo6JJJKIK5GMKZSLJ5OHK46KKZGGKJSJJ5CGJpOJLI+GK5KIKo6FKZGIKJOLJ5CIK5KHKpKKKY+HK5CJK5KGKpCJKZKIKJGGJ5OKKpKIKZCKKJKHKI+HKZKHKJKHK5GIKpOKKJCIKJKJK5CIKpGJKJKHKJCHKZCIKJGJKpKIKpCJKZGIKZCHKJGIKpKIKZKIKZGJKJCIKZGJKZKIKJGIKpGIKZGHKZKIKpCJKZGIKZKJKZGIKpCHKZGIKJKHKpGIKpGIKJGJKpKIKpGIKZGHKJCHKpKIKZGJKZGIKJCJKpGIKZGIKZGIKJGHKZGIKZKIKZGIKpGIKZGJKZKIKZGIKJGIKZCIKZGJKJGIKpKIKJCIKpGIKZKIKZGJKpCIKZGJKZKIKZGIKJGIKZCIKZKIKZGIKZGIKZGIKZGIKZGIKZGIKZKIKZGIKpGIKZGIKZGHKZGIKZGIKJGIKZGIKZGIKZGIKJCIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZGIKZH///8QAlFtAAAAnnRSTlMAAQIEBQYHCAkKCwwNDhESExQVFxkaGxweHyEkJSYnKCkqKywtLi8xMjU2Nzg6Oz0+P0BERkhJTE1OT1JTV1pbXF1eZmdpa2xvcHJ0dnd6e3x9gYSFhoeLjI2OkZOWl5iZnJ2eoKGjpaeoqautrre4vb6/wcTFxsnKy83O0tbY2drb3N3e3+Dh4+Tm5+nq6+zt7vDx8/T29/n6+/z9/ohh8dsAAAABYktHRJ/otZOdAAABlElEQVQYGW3BiVuLAQDH8d/aotiGvM7S4ajJFcnRtCiRtbByLJIVQ1RDJiTLkavNkWzW2vdvtbee8Xoen48samr1X7aRe25Zudr6boeaHdqQiRsq119O7yS8OaIJnhfvDsjC8Yi5Y3oGFzb/MrTME4qOle9lWJvS2dNV++mSad0oMC4HqZ5J4lI/I3aXpKaGfa2xzOVBloyN5nhS1qI8o1+rM/yR8V480S2pZnaxvQOINm9tuA8kbe6ZgF2lr+ZeAtl2mXqBhzOcbFKo16lxCGpbNHF3lf0tEP9ZEVHdzlvGez6vcH8CgroBWVdl15AUI29A3bw+9S6sq0DP9ZxHO+b95+GcHhDQpcOKYXosdbQUlYFfEcKqkhfTgkfyGU+nYUjHWQjWd6YwXZFUUs9ElGSxBil4sVJ5BxJuZ46zKoqw7IMhU8VwYyf82CW1fiHv+3YtsfnamL2TTh6S1vqn+FqngvXfquVjcWCjpNpKFazRwRIZQPpmtSz29G2R4xp5H4/KqjExnwKmzpTqX+5AOBL0yOo3LpiexziX8A0AAAAASUVORK5CYII=",Ie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAZCAQAAACf6xZlAAAAAmJLR0QA/4ePzL8AAAImSURBVDjLhZRNSFVREMdPlNGiTYWFm77EKErEVUgLIUWqRYvAIDLRO7+5+jT7AAmqjSDlppIwKItaWFFpaGXLhFYVJD2KzBZKRfaNditFK3RavPte7/kUz2z+cH5zZs6cmeNc2tJierXdz3ZzLd1IN4Zh/KGVFbOC/kquMRmiMQvkaMWidDBDD/IrBYzboJSmoFLEqxnBuD1gg3POudL53MJ4xpqqnJiLdvnZXh5vMUwv+1myhUkmpMo5V71a8ulngFppZATDeC31NDGKYUQ5pC2Y3IgsoczxlVPVyznG2KxJDMg2LSRK4AgwvuB7a7kzAzhOg7+ejlhtHAHv+IQR1UKvRPuSUbktm6SR8XghHQHH/Sx+YhgdVTkcCDN/zlbdy1CS83dHwFBlJo8TYU/IKm0h4hXwCMPo8fKk/j9sDDMVwmMYH70CamNvqW2yX+u0MBmO26ifwXmMCGcxjH4txrgqF6fBcoT3GGVeHkaEcxhGJ0+ZYhcT02A/l3KM3/RiRPRCPJrel7tJF9Qz2obRKYcT6US4lNAPE2rEEUijn8FgylNEuJLQn3mRBDOmu4mmwtoWqknJl9Oh/ub8zfIkCWtmBMPneryby5fJGwyjW9c559w8yvkQ1mSp1mAINxMX/IFpn1eS1P41i2liAtOT7MC0ImwdwxjWuoYF6aOVre3h+fu0C8P4S2tl5qxDK0W8xNjDPYweP3eOz6B0odTrdpp1Z/reP9LLBjo3QdHHAAAAAElFTkSuQmCC",We={T:Ke,P:ge,Z:he,N:Ie},xe={class:"raceIconRoot align-center justify-center"},Ee=["src"],w=C({__name:"RaceIcon",props:{race:null},setup(t){return(n,a)=>(s(),r("div",xe,[o("img",{src:e(We)[t.race]},null,8,Ee)]))}});const Ze={class:"d-flex"},Ge={class:"Label ml-1"},_e={class:"Label ml-auto mr-1"},be={class:"d-flex mt-auto"},Q=C({__name:"StoreItem",props:{state:null,client:null,place:null},setup(t){const n=t,a=Z(()=>{var d;return((d=n.state.player[n.client.pos])==null?void 0:d.store[n.place])||null}),l=Z(()=>{var d;return((d=n.state.player[n.client.pos])==null?void 0:d.selected)||{area:"none",place:-1}}),v={enter:"购买",combine:"三连",stage:"暂存"};return(d,I)=>{var A;return s(),G(V,{class:M(["d-flex flex-column align-self-start KeyCard",{selected:e(l).area==="store"&&e(l).place===t.place}]),color:e(a)&&((A=n.state.player[n.client.pos])!=null&&A.locked)?"cyan":"",onClick:I[0]||(I[0]=f=>t.client.autoPost(e(a)?{msg:"$select",area:"store",place:t.place}:{msg:"$select",area:"none",place:-1}))},{default:x(()=>{var f;return[e(a)?(s(),r(g,{key:0},[o("div",Ze,[K(w,{race:e(P)[e(a).card].race},null,8,["race"]),o("span",Ge,c(e(a).card),1),o("span",_e,c(e(P)[e(a).card].level),1)]),o("div",be,[(s(!0),r(g,null,E(((f=e(a))==null?void 0:f.actions)||[],(m,p)=>(s(),G(T,{variant:"text",key:`SA-${p}`,disabled:!m.enable,onClick:u=>t.client.post(m.msg)},{default:x(()=>[S(c(v[m.action]),1)]),_:2},1032,["disabled","onClick"]))),128))])],64)):J("",!0)]}),_:1},8,["color","class"])}}}),Je={class:"d-flex"},Ce={class:"Label ml-1"},Se={class:"Label ml-auto mr-1"},Te={class:"d-flex mt-auto"},Y=C({__name:"HandItem",props:{state:null,client:null,place:null},setup(t){const n=t,a=Z(()=>{var d;return((d=n.state.player[n.client.pos])==null?void 0:d.hand[n.place])||null}),l=Z(()=>{var d;return((d=n.state.player[n.client.pos])==null?void 0:d.selected)||{area:"none",place:-1}}),v={enter:"进场",combine:"三连",sell:"出售"};return(d,I)=>(s(),G(V,{class:M(["d-flex flex-column align-self-start KeyCard",{selected:e(l).area==="hand"&&e(l).place===t.place}]),onClick:I[0]||(I[0]=A=>t.client.autoPost(e(a)?{msg:"$select",area:"hand",place:t.place}:{msg:"$select",area:"none",place:-1}))},{default:x(()=>{var A;return[e(a)?(s(),r(g,{key:0},[o("div",Je,[K(w,{race:e(P)[e(a).card].race},null,8,["race"]),o("span",Ce,c(e(a).card),1),o("span",Se,c(e(P)[e(a).card].level),1)]),o("div",Te,[(s(!0),r(g,null,E(((A=e(a))==null?void 0:A.actions)||[],(f,m)=>(s(),G(T,{variant:"text",key:`HA-${m}`,disabled:!f.enable,onClick:p=>t.client.post(f.msg)},{default:x(()=>[S(c(v[f.action]),1)]),_:2},1032,["disabled","onClick"]))),128))])],64)):J("",!0)]}),_:1},8,["class"]))}}),ke={class:"d-flex flex-column"},k=C({__name:"AutoSpan",props:{text:null},setup(t){return(n,a)=>(s(),r("div",ke,[(s(!0),r(g,null,E(t.text,(l,v)=>(s(),r("div",{class:"d-flex flex-column ASRow",key:`S-${v}`},[(s(!0),r(g,null,E(l.split(`
`),(d,I)=>(s(),r("span",{class:"Info",key:`SS-${v}-${I}`},c(d),1))),128))]))),128))]))}});const Ve=ee()({name:"VDialog",props:{fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...le({origin:"center center",scrollStrategy:"block",transition:{component:me},zIndex:2400})},emits:{"update:modelValue":t=>!0},setup(t,n){let{slots:a}=n;const l=te(t,"modelValue"),{scopeId:v}=se(),d=H();function I(A){var f,m;const p=A.relatedTarget,u=A.target;if(p!==u&&(f=d.value)!=null&&f.contentEl&&(m=d.value)!=null&&m.globalTop&&![document,d.value.contentEl].includes(u)&&!d.value.contentEl.contains(u)){const i=[...d.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(_=>!_.hasAttribute("disabled")&&!_.matches('[tabindex="-1"]'));if(!i.length)return;const h=i[0],b=i[i.length-1];p===h?b.focus():h.focus()}}return re&&F(()=>l.value&&t.retainFocus,A=>{A?document.addEventListener("focusin",I):document.removeEventListener("focusin",I)},{immediate:!0}),F(l,async A=>{if(await ue(),A){var f;(f=d.value.contentEl)==null||f.focus({preventScroll:!0})}else{var m;(m=d.value.activatorEl)==null||m.focus({preventScroll:!0})}}),ae(()=>{const[A]=oe(t);return K(ce,$({ref:d,class:["v-dialog",{"v-dialog--fullscreen":t.fullscreen,"v-dialog--scrollable":t.scrollable}]},A,{modelValue:l.value,"onUpdate:modelValue":f=>l.value=f,"aria-role":"dialog","aria-modal":"true",activatorProps:$({"aria-haspopup":"dialog","aria-expanded":String(l.value)},t.activatorProps)},v),{activator:a.activator,default:function(){for(var f,m=arguments.length,p=new Array(m),u=0;u<m;u++)p[u]=arguments[u];return K(de,{root:!0},{default:()=>[(f=a.default)==null?void 0:f.call(a,...p)]})}})}),ne({},d)}});const $e=ee()({name:"VTooltip",props:{id:String,text:String,...pe(le({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":t=>!0},setup(t,n){let{slots:a}=n;const l=te(t,"modelValue"),{scopeId:v}=se(),d=ve(),I=Z(()=>t.id||`v-tooltip-${d}`),A=H(),f=Z(()=>t.location.split(" ").length>1?t.location:t.location+" center"),m=Z(()=>t.origin==="auto"||t.origin==="overlap"||t.origin.split(" ").length>1||t.location.split(" ").length>1?t.origin:t.origin+" center"),p=Z(()=>t.transition?t.transition:l.value?"scale-transition":"fade-transition");return ae(()=>{const[u]=oe(t);return K(ce,$({ref:A,class:["v-tooltip"],id:I.value},u,{modelValue:l.value,"onUpdate:modelValue":i=>l.value=i,transition:p.value,absolute:!0,location:f.value,origin:m.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:$({"aria-describedby":I.value},t.activatorProps),_disableGlobalStack:!0},v),{activator:a.activator,default:function(){for(var i,h=arguments.length,b=new Array(h),_=0;_<h;_++)b[_]=arguments[_];return((i=a.default)==null?void 0:i.call(a,...b))??t.text}})}),ne({},A)}}),we={class:"d-flex flex-column DescCol overflow-y-auto"},De={class:"Label"},Pe={class:"d-flex"},He={class:"Label"},Me={class:"Label ml-auto"},Be={class:"d-flex flex-column mt-2 overflow-y-auto"},Ue={class:"d-flex flex-column UnitCol"},Le={class:"Label"},ze={class:"d-flex flex-column UpgrCol"},Re={class:"Label"},qe={class:"d-flex"},Oe={class:"Label"},je={class:"d-flex"},Fe={class:"Label"},Ne={class:"Label ml-auto mr-1"},Qe={class:"d-flex flex-column mt-auto"},Ye={key:0,class:"d-flex justify-space-between Info"},Xe={class:"d-flex flex-column"},et={class:"d-flex flex-column justify-end"},tt={class:"d-flex justify-space-between"},at={class:"d-flex flex-column"},lt={class:"Info"},st={key:1,class:"mt-auto"},nt={class:"d-flex"},ot=C({__name:"PresentItem",props:{state:null,client:null,place:null},setup(t){const n=t,a=X(),l=Z(()=>{var p;return((p=n.state.player[n.client.pos])==null?void 0:p.present[n.place])||null}),v=Z(()=>{var u,i;const p=((i=(u=l.value)==null?void 0:u.card)==null?void 0:i.color)||"normal";return p!=="normal"?p==="gold"?"yellow":p:""}),d=Z(()=>{var p;return((p=n.state.player[n.client.pos])==null?void 0:p.selected)||{area:"none",place:-1}}),I={upgrade:"升级",sell:"出售",insert:"这里",deploy:"这里"},A=H(!1);function f(p){const u={};return p.forEach(i=>{u[i]=(u[i]||0)+1}),Object.keys(u).map(i=>`${i}	${u[i]}`)}const m=Z(()=>{var p,u;return f(((u=(p=l.value)==null?void 0:p.card)==null?void 0:u.units)||[])});return(p,u)=>(s(),G(V,{class:M(["d-flex flex-column align-self-start PresCard",{selected:e(d).area==="present"&&e(d).place===t.place}]),color:e(v),onClick:u[2]||(u[2]=i=>{var h;return t.client.autoPost((h=e(l))!=null&&h.card?{msg:"$select",area:"present",place:t.place}:{msg:"$select",area:"none",place:-1})})},{default:x(()=>[e(l)?(s(),r(g,{key:0},[e(l).card?(s(),r(g,{key:0},[K(Ve,{modelValue:A.value,"onUpdate:modelValue":u[0]||(u[0]=i=>A.value=i),class:"w-75"},{default:x(()=>[K(V,{class:"d-flex flex-row InfoCard pa-2 justify-space-between"},{default:x(()=>[o("div",we,[o("span",De,c(e(l).card.name),1),o("div",Pe,[K(w,{race:e(l).card.race},null,8,["race"]),o("span",He,c(e(l).card.level),1),o("span",Me,c(e(l).card.value),1)]),o("div",Be,[K(k,{text:e(l).card.descs},null,8,["text"]),K(k,{class:"mt-2",text:e(l).card.notes},null,8,["text"])])]),o("div",Ue,[o("span",Le," 单位 "+c(e(l).card.units.length)+" / "+c(e(l).card.config.MaxUnit),1),K(k,{class:"overflow-y-auto",text:e(m)},null,8,["text"])]),o("div",ze,[o("span",Re," 升级 "+c(e(l).card.upgrades.length)+" / "+c(e(l).card.config.MaxUpgrade),1),K(k,{text:e(l).card.upgrades},null,8,["text"])])]),_:1})]),_:1},8,["modelValue"]),o("div",qe,[K(T,{variant:"text",onClick:u[1]||(u[1]=i=>A.value=!0)},{default:x(()=>[S(" 信息 ")]),_:1})]),o("span",Oe,c(e(l).card.name),1),o("div",je,[K(w,{race:e(l).card.race},null,8,["race"]),o("span",Fe,c(e(l).card.level),1),o("span",Ne,c(e(l).card.value),1)]),K(k,{text:e(l).card.notes},null,8,["text"]),o("div",Qe,[e(a).isMobile?J("",!0):(s(),r("div",Ye,[o("div",Xe,[(s(!0),r(g,null,E(e(m).slice(0,5),(i,h)=>(s(),r("span",{key:`Unit-${h}`},c(i),1))),128))]),o("div",et,[(s(!0),r(g,null,E(e(l).card.upgrades,(i,h)=>(s(),r("span",{key:`Upgrade-${h}`},c(i),1))),128))])])),o("div",tt,[K($e,{location:"top"},{activator:x(({props:i})=>[o("span",$({class:"Info"},i),c(e(l).card.units.length)+" / "+c(e(l).card.config.MaxUnit),17)]),default:x(()=>[o("div",at,[(s(!0),r(g,null,E(e(m),(i,h)=>(s(),r("span",{class:"Info",key:`UnitTip-${h}`},c(i),1))),128))])]),_:1}),o("span",lt,c(e(l).card.upgrades.length)+" / "+c(e(l).card.config.MaxUpgrade),1)])])],64)):(s(),r("div",st)),o("div",nt,[(s(!0),r(g,null,E(e(l).actions||[],(i,h)=>(s(),G(T,{variant:"text",key:`PA-${h}`,disabled:!i.enable,onClick:b=>t.client.post(i.msg)},{default:x(()=>[S(c(I[i.action]),1)]),_:2},1032,["disabled","onClick"]))),128))])],64)):J("",!0)]),_:1},8,["color","class"]))}});const ct={key:0,class:"d-flex"},it={class:"Label ml-1"},rt={class:"Label ml-auto mr-1"},dt={key:1,class:"Label"},ut={key:2,class:"Label"},pt={key:3,class:"Label"},vt=C({__name:"DiscoverItem",props:{state:null,client:null,place:null},setup(t){const n=t,a=Z(()=>{var l,v;return((v=(l=n.state.player[n.client.pos])==null?void 0:l.discover)==null?void 0:v.item[n.place])||null});return(l,v)=>(s(),G(V,{class:"d-flex flex-column align-self-start KeyCard",onClick:v[0]||(v[0]=d=>t.client.autoPost({msg:"$choice",category:"discover",place:t.place}))},{default:x(()=>[e(a)?(s(),r(g,{key:0},[e(a).type==="card"?(s(),r("div",ct,[K(w,{race:e(a).card.race},null,8,["race"]),o("span",it,c(e(a).card.name),1),o("span",rt,c(e(a).card.level),1)])):e(a).type==="upgrade"?(s(),r("span",dt,c(e(a).upgrade.name),1)):e(a).type==="prophesy"?(s(),r("span",ut,c(e(a).prophesy.name),1)):(s(),r("span",pt,c(e(a).str),1))],64)):J("",!0)]),_:1}))}}),At={class:"d-flex flex-column pa-1"},ft={class:"d-flex"},mt={class:"d-flex flex-column"},yt={class:"Info"},Kt={class:"Info"},gt={class:"d-flex mt-auto"},ht={class:"HandContainer"},It={class:"ml-1"},Wt={class:"d-flex flex-column"},xt={class:"StoreContainer"},Et={key:0},Zt={key:0,class:"d-flex mt-2"},Gt={class:"PresentContainer"},Tt=C({__name:"GameInstance",props:{state:null,client:null},setup(t){const n=t,a=Z(()=>n.state.player[n.client.pos]),l=Z(()=>{var v;return{upgrade:"升级",refresh:"刷新",lock:"锁定",unlock:"解锁",finish:"结束",ability:((v=a.value)==null?void 0:v.role.ability)||"魂姿"}});return(v,d)=>{var I,A,f,m,p,u,i,h,b,_,B,U,L,z,R,q,O;return s(),r("div",At,[o("div",ft,[o("div",mt,[o("span",yt," 回合 "+c(t.state.round)+" 等级 "+c((I=e(a))==null?void 0:I.level)+" 生命 "+c((A=e(a))==null?void 0:A.life)+" 价值 "+c((f=e(a))==null?void 0:f.present.map(y=>{var W;return((W=y.card)==null?void 0:W.value)||0}).reduce((y,W)=>y+W,0)),1),o("span",Kt," 升级 "+c((m=e(a))==null?void 0:m.upgrade_cost)+" 晶矿 "+c((p=e(a))==null?void 0:p.mineral)+" / "+c((u=e(a))==null?void 0:u.mineral_max)+" 瓦斯 "+c((i=e(a))==null?void 0:i.gas)+" / "+c((h=e(a))==null?void 0:h.gas_max),1),o("div",gt,[(s(!0),r(g,null,E(((b=e(a))==null?void 0:b.action)||[],(y,W)=>(s(),G(T,{variant:"elevated",key:`GA-${W}`,disabled:!y.enable,onClick:_t=>t.client.post(y.msg)},{default:x(()=>[S(c(e(l)[y.action]),1)]),_:2},1032,["disabled","onClick"]))),128))]),o("div",ht,[o("div",null,[(s(),r(g,null,E(3,y=>K(Y,{class:"mt-1",key:`Hand${y-1}`,state:t.state,client:t.client,place:y-1},null,8,["state","client","place"])),64))]),o("div",It,[(s(),r(g,null,E(3,y=>K(Y,{class:"mt-1",key:`Hand${y+2}`,state:t.state,client:t.client,place:y+2},null,8,["state","client","place"])),64))])])]),o("div",Wt,[o("div",xt,[o("div",null,[(s(!0),r(g,null,E(((_=e(a))==null?void 0:_.store.slice(0,3))||[],(y,W)=>(s(),G(Q,{class:"ml-4 mt-1",key:`Store${W}`,state:t.state,client:t.client,place:W},null,8,["state","client","place"]))),128))]),(((B=e(a))==null?void 0:B.store.length)||0)>3?(s(),r("div",Et,[(s(!0),r(g,null,E(((U=e(a))==null?void 0:U.store.slice(3))||[],(y,W)=>(s(),G(Q,{class:"ml-4 mt-1",key:`Store${W}`,state:t.state,client:t.client,place:W+3},null,8,["state","client","place"]))),128))])):J("",!0)]),((L=e(a))==null?void 0:L.status)==="discover"&&e(a).discover?(s(),r("div",Zt,[(s(!0),r(g,null,E(((R=(z=e(a))==null?void 0:z.discover)==null?void 0:R.item)||[],(y,W)=>(s(),G(vt,{class:"ml-4",key:`Discover${W}`,state:t.state,client:t.client,place:W},null,8,["state","client","place"]))),128)),(O=(q=e(a))==null?void 0:q.discover)!=null&&O.extra?(s(),G(T,{key:0,onClick:d[0]||(d[0]=y=>t.client.autoPost({msg:"$choice",category:"discover",place:-1}))},{default:x(()=>{var y,W;return[S(c((W=(y=e(a))==null?void 0:y.discover)==null?void 0:W.extra),1)]}),_:1})):J("",!0)])):J("",!0)])]),o("div",Gt,[(s(),r(g,null,E(7,y=>K(ot,{class:"mt-1",key:`Present${y-1}`,state:t.state,client:t.client,place:y-1},null,8,["state","client","place"])),64))])])}}});const kt=Ae("save",()=>{const t=H(null);function n(v){t.value=v,localStorage.setItem("save",JSON.stringify({save:t.value}))}function a(){try{const{save:v}=JSON.parse(localStorage.getItem("save"));return t.value=v,!0}catch{return t.value=null,!1}}function l(){localStorage.removeItem("save"),t.value=null}return{save:t,SaveStorage:n,LoadStorage:a,CleanStorage:l}});export{Ct as C,Ve as V,St as W,Tt as _,T as a,kt as u};
